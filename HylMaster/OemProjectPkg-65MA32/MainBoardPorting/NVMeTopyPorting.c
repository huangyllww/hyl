#include "Porting.h"
#include "AmdPcieComplex.h"
#include "AutoDxioConfig.h"
#include "Token.h"
#include "AmdServerHotplug.h" //#mizl-20201014-Update For Signle CPU NVMe Config +>
//GPU Baseboard GPIO Porting
//AGPIO9_3
#define GPU_BASE_BOARD_TYPE_ID0_N(ValidSeeting) {9,DIE3,SOCKET0,ValidSeeting}//J156 A30
//AGPIO10_3
#define GPU_BASE_BOARD_TYPE_ID1_N(ValidSeeting) {10,DIE3,SOCKET0,ValidSeeting}//J173 A30
//AGPIO6
#define GPU_BASE_BOARD_TYPE_ID2_N(ValidSeeting) {6,DIE0,SOCKET0,ValidSeeting}//J157 B27

//CPU Port Type GPIO Defined
//CPU0 P0
//APGIO9_0
#define GPU_CPU0_P0_TYPE_ID0_N(ValidSeeting) {9,DIE0,SOCKET0,ValidSeeting}
//APGIO23_0
#define GPU_CPU0_P0_TYPE_ID1_N(ValidSeeting) {23,DIE0,SOCKET0,ValidSeeting}

//CPU0 P2
//APGIO19
#define GPU_CPU0_P2_TYPE_ID0_N(ValidSeeting) {19,DIE0,SOCKET0,ValidSeeting}
//APGIO20
#define GPU_CPU0_P2_TYPE_ID1_N(ValidSeeting) {20,DIE0,SOCKET0,ValidSeeting}

//CPU1 P1
//APGIO139
#define GPU_CPU1_P1_TYPE_ID0_N(ValidSeeting) {139,DIE0,SOCKET0,ValidSeeting}
//APGIO23_3
#define GPU_CPU1_P1_TYPE_ID1_N(ValidSeeting) {23,DIE3,SOCKET0,ValidSeeting}

//CPU1 P2
//APGIO10_0
#define GPU_CPU1_P2_TYPE_ID0_N(ValidSeeting) {10,DIE0,SOCKET0,ValidSeeting}
//APGIO40_0
#define GPU_CPU1_P2_TYPE_ID1_N(ValidSeeting) {40,DIE0,SOCKET0,ValidSeeting}

#define INVALID_SETTING_ARRARY {INVALID_GPIO_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING}//,"INVALID_SETTING"}

BOARD_NVME_TOPY_CONFIG X740SingleDoubleWidthNVMETopyList[]={
{
  //Board  ID GPIO Porting
 // {GPU_BASE_BOARD_TYPE_ID2_N(InputHigh),GPU_BASE_BOARD_TYPE_ID1_N(InputHigh),GPU_BASE_BOARD_TYPE_ID0_N(InputHigh)} , 
  {INVALID_SETTING_ARRARY,GPU_BASE_BOARD_TYPE_ID1_N(InputHigh),GPU_BASE_BOARD_TYPE_ID0_N(InputHigh)} ,       
  {
   //{DieNumber,StartLane,EndLane,SlaveAddress,ByteMap,ChannelNumber}
    //Socket 0 Die - 2
   {{GPU_CPU0_P2_TYPE_ID0_N(InputHigh),GPU_CPU0_P2_TYPE_ID1_N(InputHigh)},DIE2,0,3,0x44,High8BitGpio,PCA9545_Bus0,12},
   {{GPU_CPU0_P2_TYPE_ID0_N(InputHigh),GPU_CPU0_P2_TYPE_ID1_N(InputHigh)},DIE2,4,7,0x44,Low8BitGpio,PCA9545_Bus0,11}, 
   {{GPU_CPU0_P2_TYPE_ID0_N(InputHigh),GPU_CPU0_P2_TYPE_ID1_N(InputHigh)},DIE2,8,11,0x46,High8BitGpio,PCA9545_Bus0,15},
   {{GPU_CPU0_P2_TYPE_ID0_N(InputHigh),GPU_CPU0_P2_TYPE_ID1_N(InputHigh)},DIE2,12,15,0x46,Low8BitGpio,PCA9545_Bus0,14},
   //Socket 1 Die - 1
   {{GPU_CPU1_P1_TYPE_ID0_N(InputHigh),GPU_CPU1_P1_TYPE_ID1_N(InputHigh)},DIE5,0,3,0x48,High8BitGpio,PCA9545_Bus0,33},
   {{GPU_CPU1_P1_TYPE_ID0_N(InputHigh),GPU_CPU1_P1_TYPE_ID1_N(InputHigh)},DIE5,4,7,0x48,Low8BitGpio,PCA9545_Bus0,32}, 
   {{GPU_CPU1_P1_TYPE_ID0_N(InputHigh),GPU_CPU1_P1_TYPE_ID1_N(InputHigh)},DIE5,8,11,0x4a,High8BitGpio,PCA9545_Bus0,36},
   {{GPU_CPU1_P1_TYPE_ID0_N(InputHigh),GPU_CPU1_P1_TYPE_ID1_N(InputHigh)},DIE5,12,15,0x4a,Low8BitGpio,PCA9545_Bus0,35},
   //Socket 1 Die - 2
   {{GPU_CPU1_P2_TYPE_ID0_N(InputHigh),GPU_CPU1_P2_TYPE_ID1_N(InputHigh)},DIE6,0,3,0x40,High8BitGpio,PCA9545_Bus0,40},
   {{GPU_CPU1_P2_TYPE_ID0_N(InputHigh),GPU_CPU1_P2_TYPE_ID1_N(InputHigh)},DIE6,4,7,0x40,Low8BitGpio,PCA9545_Bus0,39},
   {{GPU_CPU1_P2_TYPE_ID0_N(InputHigh),GPU_CPU1_P2_TYPE_ID1_N(InputHigh)},DIE6,8,11,0x42,High8BitGpio,PCA9545_Bus0,43},
   {{GPU_CPU1_P2_TYPE_ID0_N(InputHigh),GPU_CPU1_P2_TYPE_ID1_N(InputHigh)},DIE6,12,15,0x42,Low8BitGpio,PCA9545_Bus0,42},
   {{INVALID_SETTING_ARRARY,INVALID_SETTING_ARRARY},INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING}
  }
 }
};
/*
BOARD_NVME_TOPY_CONFIG X740DoubleWidthNVMETopyList[]={
{
  //Board  ID GPIO Porting
  {GPU_BASE_BOARD_TYPE_ID2_N(InputLow),GPU_BASE_BOARD_TYPE_ID1_N(InputHigh),GPU_BASE_BOARD_TYPE_ID0_N(InputHigh)} , 
  {
   //{DieNumber,StartLane,EndLane,SlaveAddress,ByteMap,ChannelNumber}
     //Socket 0 Die - 2
     {GPU_CPU0_P2_TYPE_ID0_N(InputHigh),GPU_CPU0_P2_TYPE_ID1_N(InputHigh),DIE2,0,3,0x44,High8BitGpio,PCA9545_Bus0,12},
     {GPU_CPU0_P2_TYPE_ID0_N(InputHigh),GPU_CPU0_P2_TYPE_ID1_N(InputHigh),DIE2,4,7,0x44,Low8BitGpio,PCA9545_Bus0,11}, 
     {GPU_CPU0_P2_TYPE_ID0_N(InputHigh),GPU_CPU0_P2_TYPE_ID1_N(InputHigh),DIE2,8,11,0x46,High8BitGpio,PCA9545_Bus0,15},
     {GPU_CPU0_P2_TYPE_ID0_N(InputHigh),GPU_CPU0_P2_TYPE_ID1_N(InputHigh),DIE2,12,15,0x46,Low8BitGpio,PCA9545_Bus0,14},
     //Socket 1 Die - 1
     {GPU_CPU1_P1_TYPE_ID0_N(InputHigh),GPU_CPU1_P1_TYPE_ID1_N(InputHigh),DIE5,0,3,0x48,High8BitGpio,PCA9545_Bus0,33},
     {GPU_CPU1_P1_TYPE_ID0_N(InputHigh),GPU_CPU1_P1_TYPE_ID1_N(InputHigh),DIE5,4,7,0x48,Low8BitGpio,PCA9545_Bus0,32}, 
     {GPU_CPU1_P1_TYPE_ID0_N(InputHigh),GPU_CPU1_P1_TYPE_ID1_N(InputHigh),DIE5,8,11,0x4a,High8BitGpio,PCA9545_Bus0,36},
     {GPU_CPU1_P1_TYPE_ID0_N(InputHigh),GPU_CPU1_P1_TYPE_ID1_N(InputHigh),DIE5,12,15,0x4a,Low8BitGpio,PCA9545_Bus0,35},
     //Socket 1 Die - 2
     {GPU_CPU1_P2_TYPE_ID0_N(InputHigh),GPU_CPU1_P2_TYPE_ID1_N(InputHigh),DIE6,0,3,0x40,High8BitGpio,PCA9545_Bus0,40},
     {GPU_CPU1_P2_TYPE_ID0_N(InputHigh),GPU_CPU1_P2_TYPE_ID1_N(InputHigh),DIE6,4,7,0x40,Low8BitGpio,PCA9545_Bus0,39},
     {GPU_CPU1_P2_TYPE_ID0_N(InputHigh),GPU_CPU1_P2_TYPE_ID1_N(InputHigh),DIE6,8,11,0x42,High8BitGpio,PCA9545_Bus0,43},
     {GPU_CPU1_P2_TYPE_ID0_N(InputHigh),GPU_CPU1_P2_TYPE_ID1_N(InputHigh),DIE6,12,15,0x42,Low8BitGpio,PCA9545_Bus0,42},
     {INVALID_SETTING_ARRARY,INVALID_SETTING_ARRARY,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING}
        
  }
 }
};
*/
BOARD_NVME_TOPY_CONFIG X780CommonNVMETopyList[]={
{
  //Board  ID GPIO Porting
  {INVALID_SETTING_ARRARY,GPU_BASE_BOARD_TYPE_ID1_N(InputHigh),GPU_BASE_BOARD_TYPE_ID0_N(InputLow)} , 
  {
   //{DieNumber,StartLane,EndLane,SlaveAddress,ByteMap,ChannelNumber}
   //Socket 0 Die - 2
   {{GPU_CPU0_P2_TYPE_ID0_N(InputHigh),GPU_CPU0_P2_TYPE_ID1_N(InputHigh)},DIE2,0,3,0x48,High8BitGpio,PCA9545_Bus0,12},
   {{GPU_CPU0_P2_TYPE_ID0_N(InputHigh),GPU_CPU0_P2_TYPE_ID1_N(InputHigh)},DIE2,4,7,0x48,Low8BitGpio,PCA9545_Bus0,11}, 
   {{GPU_CPU0_P2_TYPE_ID0_N(InputHigh),GPU_CPU0_P2_TYPE_ID1_N(InputHigh)},DIE2,8,11,0x4a,High8BitGpio,PCA9545_Bus0,15},
   {{GPU_CPU0_P2_TYPE_ID0_N(InputHigh),GPU_CPU0_P2_TYPE_ID1_N(InputHigh)},DIE2,12,15,0x4a,Low8BitGpio,PCA9545_Bus0,14},
   //Socket 1 Die - 0
   {{INVALID_SETTING_ARRARY,INVALID_SETTING_ARRARY},DIE4,0,3,0x40,High8BitGpio,PCA9545_Bus0,26},
   {{INVALID_SETTING_ARRARY,INVALID_SETTING_ARRARY},DIE4,4,7,0x40,Low8BitGpio,PCA9545_Bus0,25}, 
   {{INVALID_SETTING_ARRARY,INVALID_SETTING_ARRARY},DIE4,8,11,0x42,High8BitGpio,PCA9545_Bus0,29},
   {{INVALID_SETTING_ARRARY,INVALID_SETTING_ARRARY},DIE4,12,15,0x42,Low8BitGpio,PCA9545_Bus0,28},
   //Socket 1 Die - 2
   {{GPU_CPU1_P2_TYPE_ID0_N(InputHigh),GPU_CPU1_P2_TYPE_ID1_N(InputHigh)},DIE6,0,3,0x44,High8BitGpio,PCA9545_Bus0,40},
   {{GPU_CPU1_P2_TYPE_ID0_N(InputHigh),GPU_CPU1_P2_TYPE_ID1_N(InputHigh)},DIE6,4,7,0x44,Low8BitGpio,PCA9545_Bus0,39},
   {{GPU_CPU1_P2_TYPE_ID0_N(InputHigh),GPU_CPU1_P2_TYPE_ID1_N(InputHigh)},DIE6,8,11,0x46,High8BitGpio,PCA9545_Bus0,43},
   {{GPU_CPU1_P2_TYPE_ID0_N(InputHigh),GPU_CPU1_P2_TYPE_ID1_N(InputHigh)},DIE6,12,15,0x46,Low8BitGpio,PCA9545_Bus0,42},
   {{INVALID_SETTING_ARRARY,INVALID_SETTING_ARRARY},INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING}
  }
 }
};

BOARD_NVME_TOPY_CONFIG X780BalancedModeNVMETopyList[]={
{
  //Board  ID GPIO Porting
  {INVALID_SETTING_ARRARY,GPU_BASE_BOARD_TYPE_ID1_N(InputLow),GPU_BASE_BOARD_TYPE_ID0_N(InputHigh)} , 
  {
   //{DieNumber,StartLane,EndLane,SlaveAddress,ByteMap,ChannelNumber}
   //Socket 0 Die - 0
   {{GPU_CPU0_P0_TYPE_ID0_N(InputHigh),GPU_CPU0_P0_TYPE_ID1_N(InputHigh)},DIE0,0,3,0x44,High8BitGpio,PCA9545_Bus0,2},
   {{GPU_CPU0_P0_TYPE_ID0_N(InputHigh),GPU_CPU0_P0_TYPE_ID1_N(InputHigh)},DIE0,4,7,0x44,Low8BitGpio,PCA9545_Bus0,1}, 
   {{GPU_CPU0_P0_TYPE_ID0_N(InputHigh),GPU_CPU0_P0_TYPE_ID1_N(InputHigh)},DIE0,8,11,0x46,High8BitGpio,PCA9545_Bus0,5},
   {{GPU_CPU0_P0_TYPE_ID0_N(InputHigh),GPU_CPU0_P0_TYPE_ID1_N(InputHigh)},DIE0,12,15,0x46,Low8BitGpio,PCA9545_Bus0,4},
   //Socket 0 Die - 2
   {{GPU_CPU0_P2_TYPE_ID0_N(InputHigh),GPU_CPU0_P2_TYPE_ID1_N(InputHigh)},DIE2,0,3,0x4c,High8BitGpio,PCA9545_Bus0,12},
   {{GPU_CPU0_P2_TYPE_ID0_N(InputHigh),GPU_CPU0_P2_TYPE_ID1_N(InputHigh)},DIE2,4,7,0x4c,Low8BitGpio,PCA9545_Bus0,11}, 
   {{GPU_CPU0_P2_TYPE_ID0_N(InputHigh),GPU_CPU0_P2_TYPE_ID1_N(InputHigh)},DIE2,8,11,0x4e,High8BitGpio,PCA9545_Bus0,15},
   {{GPU_CPU0_P2_TYPE_ID0_N(InputHigh),GPU_CPU0_P2_TYPE_ID1_N(InputHigh)},DIE2,12,15,0x4e,Low8BitGpio,PCA9545_Bus0,14},
   //Socket 1 Die - 0
   {{INVALID_SETTING_ARRARY,INVALID_SETTING_ARRARY},DIE4,0,3,0x40,High8BitGpio,PCA9545_Bus0,26},
   {{INVALID_SETTING_ARRARY,INVALID_SETTING_ARRARY},DIE4,4,7,0x40,Low8BitGpio,PCA9545_Bus0,25}, 
   {{INVALID_SETTING_ARRARY,INVALID_SETTING_ARRARY},DIE4,8,11,0x42,High8BitGpio,PCA9545_Bus0,29},
   {{INVALID_SETTING_ARRARY,INVALID_SETTING_ARRARY},DIE4,12,15,0x42,Low8BitGpio,PCA9545_Bus0,28},
   //Socket 1 Die - 2
   {{GPU_CPU1_P2_TYPE_ID0_N(InputHigh),GPU_CPU1_P2_TYPE_ID1_N(InputHigh)},DIE6,0,3,0x48,High8BitGpio,PCA9545_Bus0,40},
   {{GPU_CPU1_P2_TYPE_ID0_N(InputHigh),GPU_CPU1_P2_TYPE_ID1_N(InputHigh)},DIE6,4,7,0x48,Low8BitGpio,PCA9545_Bus0,39},
   {{GPU_CPU1_P2_TYPE_ID0_N(InputHigh),GPU_CPU1_P2_TYPE_ID1_N(InputHigh)},DIE6,8,11,0x4a,High8BitGpio,PCA9545_Bus0,43},
   {{GPU_CPU1_P2_TYPE_ID0_N(InputHigh),GPU_CPU1_P2_TYPE_ID1_N(InputHigh)},DIE6,12,15,0x4a,Low8BitGpio,PCA9545_Bus0,42},
   {{INVALID_SETTING_ARRARY,INVALID_SETTING_ARRARY},INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING}
  }
 }
};
/*BOARD_NVME_TOPY_CONFIG X780CommonMultiOCPNVMETopyList[]={
{
  //Board  ID GPIO Porting
  {GPU_NODE_TYPE_ID6_N(InputHigh),GPU_NODE_TYPE_ID5_N(InputLow),INVALID_SETTING_ARRARY,GPU_NODE_TYPE_ID3_N(InputHigh),GPU_NODE_TYPE_ID2_N(InputHigh),GPU_NODE_TYPE_ID1_N(InputLow),GPU_NODE_TYPE_ID0_N(InputHigh)} , 
  {
   //{DieNumber,StartLane,EndLane,SlaveAddress,ByteMap,ChannelNumber}
   //Socket 1 Die - 0
   {DIE4,0,3,0x44,High8BitGpio,PCA9545_Bus0,26},
   {DIE4,4,7,0x44,Low8BitGpio,PCA9545_Bus0,25}, 
   {DIE4,8,11,0x46,High8BitGpio,PCA9545_Bus0,29},
   {DIE4,12,15,0x46,Low8BitGpio,PCA9545_Bus0,28},
   //Socket 1 Die - 3
   {DIE7,0,3,0x40,High8BitGpio,PCA9545_Bus0,47},
   {DIE7,4,7,0x40,Low8BitGpio,PCA9545_Bus0,46},
   {DIE7,8,11,0x42,High8BitGpio,PCA9545_Bus0,50},
   {DIE7,12,15,0x42,Low8BitGpio,PCA9545_Bus0,49},
   {INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING}
  }
 }
};

BOARD_NVME_TOPY_CONFIG X780Balanced8U2NVMETopyList[]={
{
  //Board  ID GPIO Porting
  {GPU_NODE_TYPE_ID6_N(InputLow),GPU_NODE_TYPE_ID5_N(InputLow),INVALID_SETTING_ARRARY,GPU_NODE_TYPE_ID3_N(InputLow),GPU_NODE_TYPE_ID2_N(InputHigh),GPU_NODE_TYPE_ID1_N(InputHigh),GPU_NODE_TYPE_ID0_N(InputHigh)} , 
  {
   //{DieNumber,StartLane,EndLane,SlaveAddress,ByteMap,ChannelNumber}
   //Socket 1 Die - 0
   {DIE4,0,3,0x44,High8BitGpio,PCA9545_Bus0,26},
   {DIE4,4,7,0x44,Low8BitGpio,PCA9545_Bus0,25}, 
   {DIE4,8,11,0x46,High8BitGpio,PCA9545_Bus0,29},
   {DIE4,12,15,0x46,Low8BitGpio,PCA9545_Bus0,28},
   //Socket 1 Die - 2
   {DIE6,0,3,0x40,High8BitGpio,PCA9545_Bus0,40},
   {DIE6,4,7,0x40,Low8BitGpio,PCA9545_Bus0,39},
   {DIE6,8,11,0x42,High8BitGpio,PCA9545_Bus0,43},
   {DIE6,12,15,0x42,Low8BitGpio,PCA9545_Bus0,42},
   {INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING}
  }
 }
};

BOARD_NVME_TOPY_CONFIG X780Balanced16U2NVMETopyList[]={
{
  //Board  ID GPIO Porting
  {GPU_NODE_TYPE_ID6_N(InputHigh),GPU_NODE_TYPE_ID5_N(InputHigh),INVALID_SETTING_ARRARY,GPU_NODE_TYPE_ID3_N(InputLow),GPU_NODE_TYPE_ID2_N(InputHigh),GPU_NODE_TYPE_ID1_N(InputHigh),GPU_NODE_TYPE_ID0_N(InputHigh)} , 
  {
   //{DieNumber,StartLane,EndLane,SlaveAddress,ByteMap,ChannelNumber}
    //Socket 0 Die - 0
   {DIE0,0,3,0x44,High8BitGpio,PCA9545_Bus0,2},
   {DIE0,4,7,0x44,Low8BitGpio,PCA9545_Bus0,1}, 
   {DIE0,8,11,0x46,High8BitGpio,PCA9545_Bus0,5},
   {DIE0,12,15,0x46,Low8BitGpio,PCA9545_Bus0,4},
   //Socket 0 Die - 2
   {DIE2,0,3,0x40,High8BitGpio,PCA9545_Bus0,12},
   {DIE2,4,7,0x40,Low8BitGpio,PCA9545_Bus0,11},
   {DIE2,8,11,0x42,High8BitGpio,PCA9545_Bus0,15},
   {DIE2,12,15,0x42,Low8BitGpio,PCA9545_Bus0,14},
   //Socket 1 Die - 0
   {DIE4,0,3,0x4c,High8BitGpio,PCA9545_Bus0,26},
   {DIE4,4,7,0x4c,Low8BitGpio,PCA9545_Bus0,25}, 
   {DIE4,8,11,0x4e,High8BitGpio,PCA9545_Bus0,29},
   {DIE4,12,15,0x4e,Low8BitGpio,PCA9545_Bus0,28},
   //Socket 1 Die - 2
   {DIE6,0,3,0x48,High8BitGpio,PCA9545_Bus0,40},
   {DIE6,4,7,0x48,Low8BitGpio,PCA9545_Bus0,39},
   {DIE6,8,11,0x4a,High8BitGpio,PCA9545_Bus0,43},
   {DIE6,12,15,0x4a,Low8BitGpio,PCA9545_Bus0,42},
   {INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING,INVALID_SETTING}
  }
 }
};*/
